---
layout: post
title: æ ‘è“æ´¾ FAT32æ ¼å¼çš„Uç›˜æ›´æ”¹å±æ€§æˆ–è€…ç»„æç¤ºæ²¡æœ‰æƒé™
date: 2017-01-20 00:06:15
---


## é—®é¢˜æè¿°
æ ‘è“æ´¾SDå¡å†…å­˜æœ‰é™ï¼Œæ‰“ç®—æŠŠmysqlçš„data ç›®å½•è¿ç§»åˆ°Uç›˜ä¸Šæ¥ã€‚å°†Uç›˜ï¼ˆfat32æ ¼å¼ï¼‰æŒ‚è½½åˆ°/dataç›®å½•ä¸‹

```shell
sudo mkdir /data  
sudo mount /dev/sda1 /dataÂ 
sudo mkdir /data/db
#mysqlçš„dataç›®å½•è¦æ±‚ç”¨æˆ·/ç”¨æˆ·ç»„å¿…é¡»æ˜¯mysql
sudo chown mysql:mysql /data/db
```
æ‰§è¡Œåˆ°è¿™ï¼Œé—®é¢˜æ¥äº†  

```
chown: changing ownership of `/data/db': Operation not permitted
```

<!--more-->

æœ‰ç‚¹æ‡µï¼Œä¸ºå•¥è¯´æˆ‘æ²¡æƒé™æ“ä½œï¼Œ`sudo`äº†å•Šï¼Œç™¾åº¦ï¼ˆè¿™æ˜¯ä¸€ä¸ªé”™è¯¯çš„å†³å®šï¼‰ï¼Œè°·æ­Œï¼ˆç„¶å¹¶åµï¼‰ï¼Œæ‰¾äº†å‡ ä¸ªè¯•äº†ä¸‹éƒ½ä¸è¡Œï¼Œæ¯”å¦‚ï¼šå½“å‰ä¸æ˜¯rootç”¨æˆ·ï¼Œsu åˆ°root ç”¨æˆ·ä¸‹chownï¼Œä¸€ä¸ªé¬¼æ ·ã€‚  

> æ³¨æ„ï¼Œchown æˆ–è€… chmod éƒ½ä¸€æ ·ï¼Œå³ä½¿æ‰§è¡ŒæˆåŠŸï¼Œä½†æ˜¯ä¹Ÿæ˜¯æ²¡æ•ˆæœçš„

## å››å¤„ç¢°å£

`df -h` äº†ä¸‹ï¼ŒæƒŠè®¶çš„å‘ç°/dataçš„ç”¨æˆ·ï¼Œç”¨æˆ·ç»„æ˜¯piï¼Œé¡ºç€è¿™ä¸ªæ€è·¯åˆå»è°·æ­Œäº†ï¼Œè¿™å›ï¼Œç»ˆäºæ‰¾å›ç‚¹æœ‰ç”¨çš„å‘½ä»¤æ¥ï¼Œè™½ç„¶ç»“æœæ²¡ç”¨ï¼Œè‡³å°‘å­¦åˆ°äº†

```
#æŠŠUç›˜æŒ‚è½½ä»¥root ç”¨æˆ·root ç”¨æˆ·ç»„æŒ‚è½½åˆ°data ä¸‹
sudo mount -o uid=root,gid=root /dev/sda1 /data
```
æ©ï¼Œä¸å‡ºæ„å¤–çš„æ²¡ç”Ÿæ•ˆã€‚ç»§ç»­è°·æ­Œã€‚

> Add the following to /etc/fstab:  
>
> ```
> /dev/sda1 /data vfat rw,umask=000 0 0
> ```

ç¨å¾®è§£é‡Šä¸‹ï¼Œ`vfat` Uç›˜çš„fat32æ ¼å¼ï¼Œ`rw` è¯»å†™æƒé™,`umask` ç”¨æˆ·ä»¥åŠç”¨æˆ·ç»„ã€‚

é‡æ–°æŒ‚è½½ï¼Œç„¶å`df -h`ã€‚æ³ªç‰›æ»¡é¢ï¼ŒğŸ˜­ï¼Œç¥å¥‡çš„ç”¨æˆ·ç»„ç»ˆäºå˜æˆrootäº†ã€‚æ¿€åŠ¨çš„æˆ‘èµ¶ç´§`chown`ï¼Œæ›´æ”¹dbç›®å½•ç”¨æˆ·ç»„ã€‚ 

```
chown: changing ownership of `/data/db': Operation not permitted
```
ã€‚ã€‚ã€‚

è¿˜æ˜¯ä¸å¥½ä½¿ï¼Œå’‹ç ´ï¼Ÿ`umask` æ¢æˆmysqlçš„ç”¨æˆ·ç»„ï¼Ÿæ„Ÿè§‰æ€ªæ€ªçš„ï¼Œæ²¡è¿™ä¹ˆå°è¯•ã€‚ğŸ˜­

å¯»å¯»è§…è§…ï¼Œçœ‹åˆ°æœ‰äººæåˆ°nfts æˆ–è€…fat32 è¯»å†™æœ‰é—®é¢˜ï¼Œå½“ç„¶ï¼Œè·Ÿæˆ‘è¿™æ­ä¸ä¸Šè¾¹ã€‚æˆ‘è¿™æ˜¯æƒé™é—®é¢˜ã€‚ğŸ˜„ ï¼Œä½†çªç„¶æƒ³åˆ°ä¸€ç‚¹ã€‚

/etc/fstab:   

```shell  
proc            /proc           proc    defaults          0       0
/dev/mmcblk0p6  /boot           vfat    defaults          0       2
/dev/mmcblk0p7  /               ext4    defaults,noatime  0       1
```
boot ç›®å½•ä¹Ÿæ˜¯vfat çš„ï¼Œæˆ‘å°è¯•åœ¨boot ä¸‹`chown`ï¼Œæœç„¶ä¹Ÿæ˜¯ä¸å¥½ä½¿çš„ï¼Œåœ¨å…¶ä»–ç›®å½•ä¸‹å®Œå…¨æ²¡é—®é¢˜ã€‚ğŸ˜„ æ²¡æœ‰å¯¹æ¯”å°±æ²¡æœ‰ä¼¤å®³ã€‚æ‰¾åˆ°é—®é¢˜æ‰€åœ¨ã€‚ä¸‹é¢å°±ç®€å•äº†ï¼ŒæŠŠUç›˜æ ¼å¼åŒ–æˆext4æ ¼å¼å°±å¥½äº†ã€‚

## è§£å†³åŠæ³•
æ ¼å¼æ–¹æ³•:
> sudo umount /data #å¸è½½Uç›˜
> mkfs -t ext4 /dev/sda1

åœ¨æŒ‚è½½ä¸Šï¼Œ`chown` ï¼Œå¥½ä½¿äº†ã€‚ğŸ˜„
